# Отчет по проекту: CSV Chat Q&A

Данный отчет описывает выбранный подход к решению поставленной задачи, оценивает эффективность и точность работы системы, а также перечисляет применённые методы и технологии с анализом их работы. В конце приведены критерии оценки качества нашего решения.

---

## 1. Подход к решению задачи

В процессе разработки рассматривались три варианта:

1. **Подход с заранее написанными функциями:**  
   Реализовывались бы функции для максимально возможного числа потенциальных вопросов. LLM определяла бы, какую именно функцию вызвать, в зависимости от запроса пользователя.  
   **Плюсы:**  
   - **Безопасность:** Код функций написан вручную, поэтому нет риска выполнить произвольный код, сгенерированный LLM.  
   **Минусы:**  
   - Ограниченность: невозможно покрыть все возможные вопросы.  
   - Долгая реализация: каждая функция требует ручной проработки.

2. **Подход с генерацией Python-кода с помощью LLM для работы с Pandas:**  
   LLM генерировала бы код, который выполнялся бы на локальной машине для обработки данных с использованием Pandas.  
   **Минусы:**  
   - **Отсутствие безопасности:** запуск сгенерированного кода может привести к непредсказуемым результатам или даже угрозе безопасности, так как исполняется произвольный код от LLM.

3. **Подход с генерацией SQL-запросов через LLM (финальный выбор):**  
   LLM генерирует SQL-запросы, которые затем выполняются против базы данных.  
   **Плюсы:**  
   - **Контроль и безопасность:** SQL-запросы проще контролировать и проверять, что позволяет избежать выполнения произвольного кода.
   - **Гибкость:** данный подход обеспечивает большую гибкость по сравнению с заранее написанными функциями.  
   **Минусы:**  
   - Возможны ошибки в формировании SQL-запроса при недостаточно корректном формулировании вопроса пользователем.

---

## 2. Список тестовых вопросов

Для проверки точности работы системы в аналитическом модуле были использованы следующие вопросы:

- **Как различается средний доход фрилансеров, работающих на разных платформах? Выдай отрыв первого места от второго**
- **Какая категория работ приносит наибольший доход и как распределяется заработок по различным категориям?**
- **Как уровень опыта (Beginner, Intermediate, Expert) влияет на почасовую ставку и общий доход фрилансеров?**
- **Влияет ли тип проекта (Fixed против почасового) на количество выполненных работ и успешность проектов?**
- **Как отличаются оценки клиентов в зависимости от региона или платформы, где работают фрилансеры?**
- **Как влияет процент успешных проектов на рейтинг клиента и повторные заказы?**
- **Какие платформы демонстрируют лучшие показатели в плане дохода, количества завершённых проектов и повторных заказов?**
- **Как связаны длительность проекта и общий заработок фрилансера, и отличаются ли эти показатели в зависимости от типа проекта?**

---

## 3. Оценка эффективности и точности системы

- **Точность:**  
  В системе реализован модуль аналитики, который замеряет точность ответов по заранее составленным вопросам. При использовании модели _gpt-4o-mini_ достигается точность около 76.67%, а при использовании более дешевых моделей точность снижается. Это позволяет регулировать соотношение цена/качество.

- **Скорость и стоимость:**  
  Выполнение 100 запросов к _gpt-4o-mini_ обходится примерно в $0.05. При необходимости можно использовать более экономичные модели, пожертвовав некоторой точностью.

- **Гибкость:**  
  Применение SQL-запросов, генерируемых LLM, обеспечивает максимальную гибкость по сравнению с решением на базе заранее написанных функций, поскольку позволяет обрабатывать широкий спектр вопросов.

- **Безопасность:**  
  - Подход с заранее написанными функциями обеспечивает высокую безопасность, так как не предполагает выполнения кода, сгенерированного LLM; однако он ограничен в возможностях и гибкости.
  - Запуск сгенерированного LLM Python-кода менее безопасен из-за потенциального риска выполнения произвольного кода.
  - Выбранный подход (генерация SQL-запросов) является более безопасным, поскольку мы выполняем проверяемые запросы в базе данных, что позволяет сохранить контроль над операциями и снизить риск.

---

## 4. Критерии оценки качества решения

1. **Точность:**  
   Измеряется модулем аналитики, сравнивающим ответы системы с ожидаемыми значениями.

2. **Цена:**  
   Стоимость запросов к выбранной модели (например, _gpt-4o-mini_) позволяет регулировать соотношение цена/качество. Более дешевые модели стоят меньше, но точность может снижаться.

3. **Гибкость:**  
   Возможность обрабатывать широкий спектр вопросов естественным языком благодаря генерации SQL-запросов, что обеспечивает большую адаптивность по сравнению с фиксированным набором функций.

4. **Безопасность:**  
   Баланс между безопасностью и гибкостью решения: выбранный подход (генерация SQL-запросов) обеспечивает достаточную безопасность по сравнению с выполнением LLM-генерированного Python-кода, и при этом он более гибок, чем система на основе заранее написанных функций.
